<!-- Боковое меню (Sidebar) -->
<aside id="sidebar" class="fixed top-0 right-0 w-80 h-full z-50 transform translate-x-full transition-transform duration-300 bg-[#1e1e1e] border-l border-[#333] flex flex-col shadow-2xl">
  
    <!-- Шапка меню -->
    <div class="p-5 flex items-center justify-between border-b border-[#333]">
      <h2 class="text-lg font-bold tracking-wide text-gray-200">МЕНЮ</h2>
      <button id="close-sidebar-btn" class="p-1 rounded text-gray-400 hover:text-white hover:bg-white/10 transition-colors" aria-label="Close Menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
      </button>
    </div>
  
    <!-- Кнопка "Новый чат" -->
    <div class="p-4 pb-2">
      <button id="new-chat-btn" class="w-full flex items-center justify-center gap-2 py-3 px-4 rounded-lg border border-dashed border-gray-600 hover:border-white hover:bg-white/5 text-gray-300 hover:text-white transition-all text-sm font-medium">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Новый чат
      </button>
    </div>
  
    <!-- Список истории (заполняется через JS) -->
    <div class="flex-1 overflow-y-auto px-3 py-2 space-y-1" id="history-list"></div>
  
    <!-- Футер: Переключение темы -->
    <div class="p-5 border-t border-[#333] mt-auto bg-[#181818]">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3 text-gray-400">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
          <span class="text-sm font-medium">Светлая тема</span>
        </div>
        
        <label class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" id="theme-toggle" class="sr-only peer">
          <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-indigo-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
        </label>
      </div>
    </div>
  </aside>
  
  <!-- Затемнение фона -->
  <div id="overlay" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-40 transition-opacity opacity-0"></div>
  
  <style>
    /* Элементы списка истории */
    .history-item {
      display: block;
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 0.85rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: #d1d5db;
      transition: all 0.2s;
      cursor: pointer;
    }
    
    .history-item:hover {
      background-color: rgba(255,255,255,0.08);
      color: #fff;
    }
    
    .history-item.active {
      background-color: rgba(99, 102, 241, 0.15);
      color: #818cf8;
      border: 1px solid rgba(99, 102, 241, 0.3);
    }
    
    /* Адаптация под светлую тему */
    body.light #sidebar { background-color: #f3f4f6; border-left-color: #e5e7eb; }
    body.light #sidebar .border-b, body.light #sidebar .border-t { border-color: #e5e7eb; }
    body.light #sidebar .bg-\[\#181818\] { background-color: #e5e7eb; }
    body.light #sidebar h2 { color: #111; }
    
    body.light #new-chat-btn { border-color: #ccc; color: #4b5563; }
    body.light #new-chat-btn:hover { border-color: #9ca3af; background-color: rgba(0,0,0,0.05); color: #000; }
    
    body.light .history-item { color: #374151; }
    body.light .history-item:hover { background-color: rgba(0,0,0,0.05); color: #000; }
    body.light .history-item.active { background-color: #e0e7ff; color: #4f46e5; border-color: #c7d2fe; }
  </style>