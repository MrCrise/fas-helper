/* 
   === Глобальные настройки === 
   Фиксируем высоту body, чтобы избежать двойной прокрутки.
   Скролл будет только внутри контейнера чата.
*/
body { height: 100vh; overflow: hidden; }

/* 
   === Кнопка действия (Отправить / Стоп) ===
   Цвет меняется инверсивно: на темной теме кнопка белая, на светлой - черная.
*/
#action-btn { background-color: var(--text-color); color: var(--bg-color); }

/* 
   === Анимации появления сообщений === 
   Сообщения плавно выезжают снизу вверх.
*/
.msg-row { margin-bottom: 24px; display: flex; animation: fadeIn 0.2s ease-out; }
.msg-user { justify-content: flex-end; }
.msg-bot { justify-content: flex-start; }

@keyframes fadeIn { 
    from { opacity: 0; transform: translateY(5px); } 
    to { opacity: 1; transform: translateY(0); } 
}

/* 
   === Стили пузырей (Bubbles) === 
   bubble-user: пузырь пользователя (обычно серый/белый)
   bubble-bot: пузырь бота (прозрачный или с фоном карточки)
*/
.bubble { max-width: 85%; border-radius: 12px; padding: 16px 20px; font-size: 0.95rem; line-height: 1.6; word-wrap: break-word; }
.bubble-user { background-color: var(--input-bg); border: 1px solid var(--card-border); color: var(--text-color); border-bottom-right-radius: 2px; }
.bubble-bot { background-color: var(--card-bg); border: 1px solid var(--card-border); color: var(--text-color); border-bottom-left-radius: 2px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); max-width: 90%; }

/* 
   === Блок найденных документов (Sources) === 
   Карточки с метаданными и кнопкой копирования ссылки.
*/
.docs-block { margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--card-border); }
.docs-title { font-weight: 700; margin-bottom: 10px; opacity: 0.8; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.05em; display: flex; align-items: center; gap: 6px; }
.docs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 10px; }

.doc-item { 
    background-color: var(--bg-color); 
    border: 1px solid var(--card-border); 
    border-radius: 8px; 
    padding: 10px 12px; 
    display: flex; 
    align-items: flex-start; 
    gap: 10px; 
    transition: all 0.2s; 
    position: relative; 
    overflow: hidden; 
}
.doc-item:hover { border-color: #6366f1; transform: translateY(-1px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
/* Акцентная полоска слева */
.doc-item::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background-color: #6366f1; opacity: 0.7; }

.doc-icon-box { min-width: 32px; height: 32px; background: rgba(99, 102, 241, 0.1); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: #6366f1; }
.doc-content { flex: 1; min-width: 0; }
.doc-link { color: var(--text-color); text-decoration: none; font-weight: 600; font-size: 0.85rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; margin-bottom: 2px; }
.doc-link:hover { color: #6366f1; }
.doc-meta-row { display: flex; align-items: center; justify-content: space-between; font-size: 0.75rem; }
.doc-badge { background: rgba(255,255,255,0.05); padding: 2px 6px; border-radius: 4px; font-family: monospace; opacity: 0.8; }
.doc-copy-btn { opacity: 0.6; transition: opacity 0.2s; cursor: pointer; }
.doc-copy-btn:hover { opacity: 1; color: #6366f1; }

/* 
   === Элементы истории в сайдбаре === 
   Используем flex для размещения названия и кнопок действий (удалить/изменить).
*/
.history-item { display: flex !important; justify-content: space-between; align-items: center; width: 100%; padding: 10px 12px; border-radius: 6px; font-size: 0.85rem; color: #d1d5db; transition: all 0.2s; cursor: pointer; border: 1px solid transparent; }
.history-item:hover { background-color: rgba(255,255,255,0.08); color: #fff; }
.history-item.active { background-color: rgba(99, 102, 241, 0.15); color: #818cf8; border-color: rgba(99, 102, 241, 0.3); }

.history-title-span { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-right: 8px; }
/* Кнопки появляются только при наведении (hover) */
.history-actions { display: none; gap: 4px; align-items: center; }
.history-item:hover .history-actions, .history-item.active .history-actions { display: flex; }

.history-btn { padding: 4px; border-radius: 4px; color: inherit; opacity: 0.6; transition: all 0.2s; }
.history-btn:hover { opacity: 1; background-color: rgba(255,255,255,0.15); }
.history-btn.delete:hover { color: #ef4444; }
.history-edit-input { width: 100%; background: transparent; border: 1px solid #6366f1; border-radius: 4px; color: inherit; padding: 2px 4px; font-size: inherit; outline: none; }

/* 
   === Markdown Styles === 
   Стилизация сгенерированного HTML из Markdown (заголовки, списки, код).
*/
.answer-markdown h1 { font-size: 1.4em; border-bottom: 1px solid var(--card-border); padding-bottom: 0.3em; margin-top: 1.2em; font-weight: 700; }
.answer-markdown h2 { font-size: 1.2em; margin-top: 1em; font-weight: 700; }
.answer-markdown p { margin-bottom: 0.8em; }
.answer-markdown ul, .answer-markdown ol { margin: 0.5em 0 1em 1.5em; }
.answer-markdown ul { list-style: disc; } .answer-markdown ol { list-style: decimal; }
.answer-markdown code { background: rgba(128,128,128,0.15); padding: 2px 5px; border-radius: 4px; font-family: monospace; font-size: 0.9em; }
.answer-markdown pre { background: var(--bg-color); padding: 12px; border-radius: 8px; margin: 1em 0; overflow-x: auto; border: 1px solid var(--card-border); }
.answer-markdown a { color: #6366f1; text-decoration: underline; }

/* 
   === Индикатор печати (Typing Indicator) === 
   Три анимированные точки.
*/
.typing-indicator { display: inline-flex; align-items: center; height: 24px; margin: 8px 0; }
.typing-dot { width: 8px; height: 8px; margin-right: 4px; border-radius: 50%; background-color: var(--text-color); opacity: 0.3; animation: typingBounce 1.4s infinite ease-in-out both; }
.typing-dot:nth-child(1) { animation-delay: -0.32s; } 
.typing-dot:nth-child(2) { animation-delay: -0.16s; } 
.typing-dot:nth-child(3) { animation-delay: 0s; }

@keyframes typingBounce { 
    0%, 80%, 100% { transform: scale(0); opacity: 0.3; } 
    40% { transform: scale(1); opacity: 1; } 
}